<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ejemplo de Callbacks</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-4">
    <label>Nombre Completo</label>
    <input type="text" id="nameInput" class="form-control" placeholder="Juan Gómez Martínez">
    <br>
    <label>Fecha de Nacimiento</label>
    <input type="date" id="birthDateInput" class="form-control">
    <br><br>
    <button id="infoButton" class="btn btn-primary" onclick="showInfo()">Mostrar Información</button>
  </div>
  <div class="container_results mt-4">
    <div id="resultName" class="mb-2"></div>
    <div id="resultAge"></div>
  </div>

  <script>
    // await
    async function showNameAfterDelay() {
      const nameInput = document.getElementById('nameInput').value;
      await new Promise(resolve => setTimeout(resolve, 3000));
      document.getElementById('resultName').textContent = `Nombre Completo: ${nameInput}`;
    }

    // calcular la edad en años y días. 
    async function showAgeAfterDelay() {
      const birthDateInput = document.getElementById('birthDateInput').value;
      if (birthDateInput) {
        const birthDate = new Date(birthDateInput);
        const today = new Date();
        
        // Calcular la edad en años
        let ageInYears = today.getFullYear() - birthDate.getFullYear();
        
        // Ajustar si el cumpleaños aún no ha ocurrido este año
        const monthDiff = today.getMonth() - birthDate.getMonth();
        const dayDiff = today.getDate() - birthDate.getDate();
        if (monthDiff < 0 || (monthDiff === 0 && dayDiff < 0)) {
          ageInYears--;
        }

        // Calcular la edad 
        const ageInDays = Math.floor((today - birthDate) / (1000 * 60 * 60 * 24));

        await new Promise(resolve => setTimeout(resolve, 3000));
        document.getElementById('resultAge').textContent = `Edad: ${ageInYears} años (${ageInDays} días)`;
      } else {
        document.getElementById('resultAge').textContent = "Por favor, ingrese una fecha de nacimiento válida.";
      }
    }

    // Botón
    async function showInfo() {
      const button = document.getElementById('infoButton');
      button.classList.add('disabled');
      button.setAttribute('disabled', 'true');
      document.getElementById('resultName').textContent = "Cargando...";
      document.getElementById('resultAge').textContent = "Cargando...";

      // Funciones nombre y edad
      await showNameAfterDelay();
      await showAgeAfterDelay();

      // Reactivar botón cuando termine
      button.classList.remove('disabled');
      button.removeAttribute('disabled');
    }
  </script>
</body>
</html>