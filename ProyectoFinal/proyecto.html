<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Encuestas</title>
    <style>
        h2 {
            text-align: center;
            font-weight: lighter;
        }
        table {
            width: fit-content;
            border-radius: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 5px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        tr:hover {
            background-color: #f1f1f1;
            cursor: pointer;
        }
        .form-group {
            background-color: darkgray;
            margin-bottom: 15px;
        }
        .container {
            display: flex;
        }
        .centrar {
            padding-bottom: 10px;
            text-align: center;
        }
        .form-container {
            display: flex;
            flex-direction: row;
            gap: 5px;
            margin-left: 20px;
            margin-right: 20px;
            margin-top: 20px;
        }
        button {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="centrar">
        <h1>Usuarios para aplicar encuesta</h1>
        <input type="text" id="nombreUsuario" placeholder="Selecciona un usuario" readonly>
    </div>
    <div class="container">
        <!--<input type="text" id="nombreUsuario" placeholder="Selecciona un usuario" readonly> -->
        <table id="tablaUsuarios">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <!-- Contenedor de Formularios -->
        <div class="form-container">
            <!-- Formulario de Encuesta 1-->
            <form id="surveyForm1">
                <h2>Encuesta 1</h2>
                <div class="form-group">
                    <label>¿Cómo calificaría nuestro servicio? (1 a 5)</label>
                    <input type="number" id="serviceRating" min="1" max="5" required>
                </div>
                <div class="form-group">
                    <label>¿Recomendaría nuestro producto a otros?</label>
                    <select id="recommend" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>¿En que color le gusta el producto?</label>
                    <select id="color" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Blanco">Blanco</option>
                        <option value="Negro">Negro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>¿Qué tan satisfecho está con la atención al cliente? (1 a 5)</label>
                    <input type="number" id="satisfaction" min="1" max="5" required>
                </div>
                <div class="form-group">
                    <label>¿Con qué frecuencia usa nuestro producto?</label>
                    <select id="frequency" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Diario">Diario</option>
                        <option value="Semanal">Semanal</option>
                        <option value="Mensual">Mensual</option>
                        <option value="Rara vez">Rara vez</option>
                    </select>
                </div>
            </form>

            <!-- Formulario de Encuesta 2-->
            <form id="surveyForm2">
                <h2>Encuesta 2</h2>
                <div class="form-group">
                    <label>¿Qué tan satisfecho(a) estás con la atención al cliente que recibiste durante tu visita? (1 a 5)</label>
                    <input type="number" id="serviceRating2" min="1" max="5" required>
                </div>
                <div class="form-group">
                    <label>¿Cómo calificarías la limpieza y organización de la tienda?</label>
                    <select id="frequency2" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Excelente">Excelente</option>
                        <option value="Buena">Buena</option>
                        <option value="Regular">Regular</option>
                        <option value="Mala">Mala</option>
                        <option value="Muy Mala">Muy Mala</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>¿Recomendaría nuestro producto a otros?</label>
                    <select id="recommend2" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="Solo">Solo algunos productos</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>¿Qué tan satisfecho(a) estás con la relación calidad-precio de los productos que compraste? (1 a 5)</label>
                    <input type="number" id="satisfaction2" min="1" max="5" required>
                </div>
                <div class="form-group">
                    <label>¿Volverías a comprar en esta tienda?</label>
                    <select id="volver2" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="Solo">No estoy seguro</option>
                        <option value="No">No</option>
                    </select>
                </div>
            </form>

            <!-- Formulario de Encuesta 3-->
            <form id="surveyForm3">
                <h2>Encuesta 3</h2>
                <div class="form-group">
                    <label>¿Qué tan satisfecho(a) estás con la calidad de los alimentos que consumiste? (1 a 5)</label>
                    <input type="number" id="serviceRating3" min="1" max="5" required>
                </div>
                <div class="form-group">
                    <label>¿Cómo calificarías la atención que recibiste por parte del personal?</label>
                    <select id="frequency3" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Excelente">Excelente</option>
                        <option value="Buena">Buena</option>
                        <option value="Regular">Regular</option>
                        <option value="Mala">Mala</option>
                        <option value="Muy Mala">Muy Mala</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>¿El tiempo de espera para recibir tu pedido fue adecuado?</label>
                    <select id="recommend3" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="Solo">No, fue un poco lento</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>¿Qué tan satisfecho(a) estás con la relación calidad-precio de tu experiencia en el restaurante? (1 a 5)</label>
                    <input type="number" id="satisfaction3" min="1" max="5" required>
                </div>
                <div class="form-group">
                    <label>¿Recomendarías este restaurante a familiares y amigos?</label>
                    <select id="volver3" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Sí">Sí</option>
                        <option value="Solo">No estoy seguro</option>
                        <option value="No">No</option>
                    </select>
                </div>
            </form>
        </div>
    </div>
    <div class="centrar">
        <button type="button" onclick="enviarRespuestas()">Enviar Encuestas</button>
        
    </div>
    <div class="centrar">
        <label>Selecciona un usuario para mostrar la estadística</label>
        <select id="useR">
            <option value="">Selecciona uno</option>
        </select>
    </div>
    

    <script>
        // Definiciónn de la matriz para almacenar respuestas de usuarios
        const matrizRespuestas = [];
        
        // Función para obtener usuarios de la API
        async function obtenerUsuarios() {
            try {
                const respuesta = await fetch('https://jsonplaceholder.typicode.com/users');
                const usuarios = await respuesta.json();
                verUsuarios(usuarios);
            } catch (error) {
                console.error('Error al obtener los usuarios:', error);
            }
        }

        // Función para visualizar los usuarios en una tabla
        function verUsuarios(usuarios) {
            const tablaCuerpo = document.querySelector('#tablaUsuarios tbody');
            tablaCuerpo.innerHTML = ''; // Limpiar tabla antes de llenarla

            usuarios.forEach(usuario => {
                const fila = document.createElement('tr');

                fila.innerHTML = `
                    <td>${usuario.id}</td>
                    <td class="nombre">${usuario.name}</td>
                `;

                // Evento click en la fila del nombre
                fila.querySelector('.nombre').addEventListener('click', () => {
                    document.getElementById('nombreUsuario').value = usuario.name;
                });

                tablaCuerpo.appendChild(fila);
            });
        }
        // Función para validar las respuestas en las encuestas
        function validarEncuestas(encuestaId) {
            const form = document.getElementById(encuestaId);
            const inputs = form.querySelectorAll('input, select');

            for (let input of inputs) {
                if (!input.value) {
                    alert(`Por favor, responde todas las preguntas en la ${form.querySelector('h2').innerText}.`);
                    return false;
                }
            }
            return true;

        }
        
        // Función para validar y guardar respuestas en la matriz
        function enviarRespuestas() {
            const nombreUsuario = document.getElementById('nombreUsuario').value;        

            //Validar que se elija un nombre de usuario
            if (!nombreUsuario) {
                alert("Por favor, elije un nombre de Usuario de la lista");
                return;
            }

            // Validar uqe las encuestas tengan un valor
            if (!validarEncuestas('surveyForm1') || !validarEncuestas('surveyForm2') || !validarEncuestas('surveyForm3')) {
                return;
            }
            

            // Crear un objeto con las respuestas del usuario
            const respuestas = {
                nombreUsuario: nombreUsuario,
                encuesta1: {
                    serviceRating: document.getElementById('serviceRating').value,
                    recommend: document.getElementById('recommend').value,
                    color: document.getElementById('color').value,
                    satisfaction: document.getElementById('satisfaction'),
                    frequency: document.getElementById('frequency')
                },
                encuesta2: {
                    serviceRating2: document.getElementById('serviceRating2').value,
                    frequency2: document.getElementById('frequency2').value,
                    recommend2 : document.getElementById('recommend2').value,
                    satisfaction2: document.getElementById('satisfaction2').value,
                    volver2: document.getElementById('volver2').value
                },
                encuesta3: {
                    serviceRating3: document.getElementById('serviceRating3').value,
                    frequency3: document.getElementById('frequency3').value,
                    recommend3 : document.getElementById('recommend3').value,
                    satisfaction3: document.getElementById('satisfaction3').value,
                    volver3: document.getElementById('volver3').value
                }
                
            };

            // Almacenar la respuesta en el arreglo
            matrizRespuestas.push(respuestas);
            console.log(matrizRespuestas);

            // Limpiar las encuestas y el input con nombre de usuario
            document.querySelectorAll('form').forEach(form=>form.reset());
            
            // Mostrar agradecimiento
            alert("Gracias por completar las encuestas.");
        }
        // Actualizar el selector con los nombres de usuarios que realizaron encuestas
        function actualizarSelector() {
            const useR = document.getElementById('useR');
            matrizRespuestas.forEach((nombreUsuario, index) => {
                const option = document.createElement('option');
                option.value=index;
                option.textContent = nombreUsuario;
                useR.appendChild('option');
            }
            )};
        }


        // Llamar a la función para cargar usuarios al iniciar la página
        obtenerUsuarios();
    </script>
</body>
</html>
